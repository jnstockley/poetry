FROM python:3.12.8-alpine

RUN apk update && \
    apk upgrade && \
    apk add alpine-sdk python3-dev musl-dev libffi-dev gcc curl openssl-dev cargo pkgconfig && \
    addgroup -S python3 && adduser -S python3 -G python3 && \
    curl -sSL https://install.python-poetry.org | python3 -

COPY requirements.txt .

RUN pip install --upgrade pip && \
    pip install --user -r requirements.txt

FROM python:3.12.8-alpine

COPY --from=build /root/.local/ /usr/local/
